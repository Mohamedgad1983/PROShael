<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clear Cache & Reload PWA</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #0f172a;
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            direction: rtl;
        }
        .container {
            background: #1e293b;
            padding: 40px;
            border-radius: 16px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        h1 {
            color: #60a5fa;
            margin-bottom: 20px;
        }
        .btn {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
            font-weight: 600;
            transition: background 0.1s;
        }
        .btn:hover {
            background: #2563eb;
        }
        .btn-success {
            background: #22c55e;
        }
        .btn-success:hover {
            background: #16a34a;
        }
        .btn-warning {
            background: #f59e0b;
        }
        .btn-warning:hover {
            background: #d97706;
        }
        .status {
            margin-top: 20px;
            padding: 16px;
            border-radius: 8px;
            background: rgba(34, 197, 94, 0.1);
            border: 1px solid rgba(34, 197, 94, 0.2);
            color: #22c55e;
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”„ Ù…Ø³Ø­ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ© Ù„Ù„Ù…ØªØµÙØ­</h1>

        <p>Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø£Ø¯Ù†Ø§Ù‡ Ù„Ù…Ø³Ø­ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ© ÙˆØ¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</p>

        <button class="btn" onclick="clearCacheAndReload()">
            Ù…Ø³Ø­ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ© ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        </button>

        <button class="btn btn-success" onclick="openPWAWithCache()">
            ÙØªØ­ PWA Ù…Ø¹ Ù…Ø³Ø­ Ø§Ù„Ø°Ø§ÙƒØ±Ø©
        </button>

        <button class="btn btn-warning" onclick="hardRefresh()">
            Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ù‚ÙˆÙŠØ© (Ctrl+F5)
        </button>

        <div id="status" style="display: none;" class="status"></div>

        <hr style="margin: 30px 0; border: 1px solid rgba(255,255,255,0.1);">

        <h3 style="color: #cbd5e1;">Ø¥Ø±Ø´Ø§Ø¯Ø§Øª ÙŠØ¯ÙˆÙŠØ©:</h3>
        <ol style="text-align: right; color: #94a3b8;">
            <li>Ø§Ø¶ØºØ· <strong>Ctrl + Shift + R</strong> (Ø£Ùˆ Cmd + Shift + R Ø¹Ù„Ù‰ Mac)</li>
            <li>Ø£Ùˆ Ø§Ø¶ØºØ· <strong>F12</strong> Ù„ÙØªØ­ Developer Tools</li>
            <li>Ø§Ù†Ù‚Ø± Ø¨Ø²Ø± Ø§Ù„Ù…Ø§ÙˆØ³ Ø§Ù„Ø£ÙŠÙ…Ù† Ø¹Ù„Ù‰ Ø²Ø± Refresh ÙˆØ§Ø®ØªØ± "Empty Cache and Hard Reload"</li>
            <li>ÙÙŠ Chrome: Settings â†’ Privacy â†’ Clear browsing data â†’ Cached images and files</li>
        </ol>
    </div>

    <script>
        function showStatus(message, success = true) {
            const status = document.getElementById('status');
            status.style.display = 'block';
            status.innerHTML = message;
            status.style.background = success ? 'rgba(34, 197, 94, 0.1)' : 'rgba(239, 68, 68, 0.1)';
            status.style.borderColor = success ? 'rgba(34, 197, 94, 0.2)' : 'rgba(239, 68, 68, 0.2)';
            status.style.color = success ? '#22c55e' : '#ef4444';
        }

        async function clearCacheAndReload() {
            showStatus('<div class="loading"></div> Ø¬Ø§Ø±ÙŠ Ù…Ø³Ø­ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ©...');

            // Clear localStorage
            localStorage.clear();
            sessionStorage.clear();

            // Clear service worker caches if available
            if ('caches' in window) {
                const cacheNames = await caches.keys();
                await Promise.all(
                    cacheNames.map(cacheName => caches.delete(cacheName))
                );
            }

            // Unregister service workers
            if ('serviceWorker' in navigator) {
                const registrations = await navigator.serviceWorker.getRegistrations();
                for(let registration of registrations) {
                    await registration.unregister();
                }
            }

            showStatus('âœ… ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ© Ø¨Ù†Ø¬Ø§Ø­! Ø¬Ø§Ø±ÙŠ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„...');

            setTimeout(() => {
                // Force reload with cache bypass
                window.location.href = 'http://localhost:3002/pwa?v=' + Date.now();
            }, 2000);
        }

        function openPWAWithCache() {
            showStatus('Ø¬Ø§Ø±ÙŠ ÙØªØ­ PWA Ù…Ø¹ Ù…Ø³Ø­ Ø§Ù„Ø°Ø§ÙƒØ±Ø©...');

            // Clear localStorage for PWA
            localStorage.removeItem('pwa_user');
            localStorage.removeItem('pwa_token');

            // Open with cache-busting parameter
            const timestamp = Date.now();
            window.open('http://localhost:3002/pwa/login?cache=' + timestamp, '_blank');

            showStatus('âœ… ØªÙ… ÙØªØ­ PWA ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø©');
        }

        function hardRefresh() {
            showStatus('Ø¬Ø§Ø±ÙŠ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚ÙˆÙŠ...');

            // Try to simulate Ctrl+F5
            location.reload(true);

            // Fallback with cache-busting
            setTimeout(() => {
                window.location.href = 'http://localhost:3002/pwa?t=' + new Date().getTime();
            }, 100);
        }

        // Auto clear on load
        window.addEventListener('load', () => {
            // Clear any cached data
            if (performance && performance.navigation.type === 1) {
                console.log('Page reloaded');
            }
        });
    </script>
</body>
</html>